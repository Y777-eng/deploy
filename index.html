<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIæ•™æ¡ˆPPTç”Ÿæˆå™¨</title>
    <link rel="stylesheet" href="/deploy/style.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Microsoft YaHei', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            max-width: 600px;
            width: 100%;
            padding: 40px;
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .header h1 {
            color: #333;
            font-size: 32px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .header .icon {
            font-size: 40px;
        }

        .header p {
            color: #666;
            font-size: 16px;
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            color: #333;
            font-weight: 600;
            margin-bottom: 8px;
            font-size: 14px;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 15px;
            transition: all 0.3s;
            font-family: inherit;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .form-group textarea {
            resize: vertical;
            min-height: 100px;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .slider-container {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .slider-container input[type="range"] {
            flex: 1;
            height: 6px;
            border-radius: 5px;
            background: #e0e0e0;
            outline: none;
        }

        .slider-container input[type="range"]::-webkit-slider-thumb {
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #667eea;
            cursor: pointer;
        }

        .slider-value {
            min-width: 60px;
            text-align: center;
            font-weight: 600;
            color: #667eea;
            font-size: 18px;
        }

        .btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .spinner {
            display: none;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .btn.loading .spinner {
            display: block;
        }

        .btn.loading .btn-text {
            display: none;
        }

        .alert {
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: none;
            animation: slideDown 0.3s ease-out;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .alert.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .alert.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .alert.show {
            display: block;
        }

        .download-link {
            display: inline-block;
            margin-top: 10px;
            padding: 10px 20px;
            background: #28a745;
            color: white;
            text-decoration: none;
            border-radius: 8px;
            font-weight: 600;
            transition: all 0.3s;
        }

        .download-link:hover {
            background: #218838;
            transform: translateY(-2px);
        }

        .examples {
            margin-top: 30px;
            padding-top: 30px;
            border-top: 2px solid #f0f0f0;
        }

        .examples h3 {
            color: #333;
            font-size: 18px;
            margin-bottom: 15px;
        }

        .example-item {
            background: #f8f9fa;
            padding: 12px 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
        }

        .example-item:hover {
            background: #e9ecef;
            border-color: #667eea;
            transform: translateX(5px);
        }

        .example-item strong {
            color: #667eea;
            display: block;
            margin-bottom: 5px;
        }

        .example-item span {
            color: #666;
            font-size: 14px;
        }

        .footer {
            text-align: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 2px solid #f0f0f0;
            color: #999;
            font-size: 14px;
        }

        @media (max-width: 600px) {
            .container {
                padding: 30px 20px;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .header h1 {
                font-size: 26px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>
                <span class="icon">ğŸ¯</span>
                AIæ•™æ¡ˆPPTç”Ÿæˆå™¨
            </h1>
            <p>è¾“å…¥æ•™å­¦ä¸»é¢˜ï¼ŒAIè‡ªåŠ¨ç”Ÿæˆä¸“ä¸šæ•™æ¡ˆPPT</p>
        </div>

        <div id="alert" class="alert"></div>

        <form id="pptForm">
            <div class="form-row">
                <div class="form-group">
                    <label for="grade">å¹´çº§</label>
                    <select id="grade" name="grade">
                        <option value="">è¯·é€‰æ‹©</option>
                        <option value="å°å­¦ä¸€å¹´çº§">å°å­¦ä¸€å¹´çº§</option>
                        <option value="å°å­¦äºŒå¹´çº§">å°å­¦äºŒå¹´çº§</option>
                        <option value="å°å­¦ä¸‰å¹´çº§">å°å­¦ä¸‰å¹´çº§</option>
                        <option value="å°å­¦å››å¹´çº§">å°å­¦å››å¹´çº§</option>
                        <option value="å°å­¦äº”å¹´çº§">å°å­¦äº”å¹´çº§</option>
                        <option value="å°å­¦å…­å¹´çº§">å°å­¦å…­å¹´çº§</option>
                        <option value="åˆä¸­ä¸€å¹´çº§">åˆä¸­ä¸€å¹´çº§</option>
                        <option value="åˆä¸­äºŒå¹´çº§">åˆä¸­äºŒå¹´çº§</option>
                        <option value="åˆä¸­ä¸‰å¹´çº§">åˆä¸­ä¸‰å¹´çº§</option>
                        <option value="é«˜ä¸­ä¸€å¹´çº§">é«˜ä¸­ä¸€å¹´çº§</option>
                        <option value="é«˜ä¸­äºŒå¹´çº§">é«˜ä¸­äºŒå¹´çº§</option>
                        <option value="é«˜ä¸­ä¸‰å¹´çº§">é«˜ä¸­ä¸‰å¹´çº§</option>
                        <option value="å¤§å­¦">å¤§å­¦</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="subject">å­¦ç§‘</label>
                    <select id="subject" name="subject">
                        <option value="é€šç”¨">é€šç”¨</option>
                        <option value="è¯­æ–‡">è¯­æ–‡</option>
                        <option value="æ•°å­¦">æ•°å­¦</option>
                        <option value="è‹±è¯­">è‹±è¯­</option>
                        <option value="ç‰©ç†">ç‰©ç†</option>
                        <option value="åŒ–å­¦">åŒ–å­¦</option>
                        <option value="ç”Ÿç‰©">ç”Ÿç‰©</option>
                        <option value="å†å²">å†å²</option>
                        <option value="åœ°ç†">åœ°ç†</option>
                        <option value="æ”¿æ²»">æ”¿æ²»</option>
                        <option value="ä¿¡æ¯æŠ€æœ¯">ä¿¡æ¯æŠ€æœ¯</option>
                        <option value="éŸ³ä¹">éŸ³ä¹</option>
                        <option value="ç¾æœ¯">ç¾æœ¯</option>
                        <option value="ä½“è‚²">ä½“è‚²</option>
                    </select>
                </div>
            </div>

            <div class="form-group">
                <label for="topic">æ•™æ¡ˆä¸»é¢˜ *</label>
                <textarea id="topic" name="topic" placeholder="ä¾‹å¦‚ï¼šåˆ†æ•°çš„åŠ å‡æ³•ã€å¤è¯—è¯é‰´èµã€ç‰›é¡¿ç¬¬ä¸€å®šå¾‹..." required></textarea>
            </div>

            <div class="form-group">
                <label for="duration">è¯¾æ—¶å®‰æ’</label>
                <select id="duration" name="duration">
                    <option value="1è¯¾æ—¶">1è¯¾æ—¶ (45åˆ†é’Ÿ)</option>
                    <option value="2è¯¾æ—¶">2è¯¾æ—¶ (90åˆ†é’Ÿ)</option>
                    <option value="å•å…ƒè¯¾ç¨‹">å•å…ƒè¯¾ç¨‹ (å¤šè¯¾æ—¶)</option>
                </select>
            </div>

            <div class="form-group">
                <label for="teaching_method">æ•™å­¦æ–¹æ³•</label>
                <select id="teaching_method" name="teaching_method">
                    <option value="è®²æˆæ³•">è®²æˆæ³•</option>
                    <option value="è®¨è®ºæ³•">è®¨è®ºæ³•</option>
                    <option value="å®éªŒæ³•">å®éªŒæ³•</option>
                    <option value="æ¡ˆä¾‹æ•™å­¦æ³•">æ¡ˆä¾‹æ•™å­¦æ³•</option>
                    <option value="é¡¹ç›®å¼å­¦ä¹ ">é¡¹ç›®å¼å­¦ä¹ </option>
                    <option value="ç¿»è½¬è¯¾å ‚">ç¿»è½¬è¯¾å ‚</option>
                    <option value="æ··åˆå¼æ•™å­¦">æ··åˆå¼æ•™å­¦</option>
                </select>
            </div>

            <div class="form-group">
                <label for="class_size">ç­çº§è§„æ¨¡</label>
                <select id="class_size" name="class_size">
                    <option value="å°ç­ (20äººä»¥ä¸‹)">å°ç­ (20äººä»¥ä¸‹)</option>
                    <option value="ä¸­ç­ (20-40äºº)">ä¸­ç­ (20-40äºº)</option>
                    <option value="å¤§ç­ (40äººä»¥ä¸Š)">å¤§ç­ (40äººä»¥ä¸Š)</option>
                </select>
            </div>

            <div class="form-group">
                <label for="num_slides">å¹»ç¯ç‰‡æ•°é‡ï¼š<span class="slider-value" id="slideValue">6</span> é¡µ</label>
                <div class="slider-container">
                    <input type="range" id="num_slides" name="num_slides" min="3" max="15" value="6" oninput="updateSliderValue(this.value)">
                </div>
            </div>

            <button type="submit" class="btn" id="submitBtn">
                <span class="spinner"></span>
                <span class="btn-text">ğŸš€ ç”ŸæˆPPT</span>
            </button>
        </form>

        <div class="examples">
            <h3>ğŸ’¡ æ•™æ¡ˆç¤ºä¾‹ï¼ˆç‚¹å‡»å¿«é€Ÿå¡«å……ï¼‰</h3>
            <div class="example-item" onclick="fillCompleteExample('å°å­¦ä¸‰å¹´çº§', 'æ•°å­¦', 'åˆ†æ•°çš„è®¤è¯†ä¸åŠ å‡æ³•', '1è¯¾æ—¶', 'è®²æˆæ³•', 'ä¸­ç­ (20-40äºº)')">
                <strong>å°å­¦æ•°å­¦æ•™æ¡ˆ</strong>
                <span>åˆ†æ•°çš„è®¤è¯†ä¸åŠ å‡æ³• - é€‚åˆä¸­ç­è§„æ¨¡ï¼Œé‡‡ç”¨è®²æˆæ³•æ•™å­¦</span>
            </div>
            <div class="example-item" onclick="fillCompleteExample('åˆä¸­äºŒå¹´çº§', 'ç‰©ç†', 'ç‰›é¡¿ç¬¬ä¸€å®šå¾‹ä¸æƒ¯æ€§', '1è¯¾æ—¶', 'å®éªŒæ³•', 'ä¸­ç­ (20-40äºº)')">
                <strong>åˆä¸­ç‰©ç†æ•™æ¡ˆ</strong>
                <span>ç‰›é¡¿ç¬¬ä¸€å®šå¾‹ä¸æƒ¯æ€§ - å®éªŒæ•™å­¦æ³•ï¼ŒåŸ¹å…»ç§‘å­¦æ¢ç©¶èƒ½åŠ›</span>
            </div>
            <div class="example-item" onclick="fillCompleteExample('é«˜ä¸­ä¸€å¹´çº§', 'è‹±è¯­', 'è‹±è¯­æ—¶æ€è¯¦è§£ï¼šç°åœ¨å®Œæˆæ—¶', '2è¯¾æ—¶', 'è®¨è®ºæ³•', 'ä¸­ç­ (20-40äºº)')">
                <strong>é«˜ä¸­è‹±è¯­æ•™æ¡ˆ</strong>
                <span>ç°åœ¨å®Œæˆæ—¶ - è®¨è®ºå¼æ•™å­¦ï¼Œæé«˜è¯­è¨€è¿ç”¨èƒ½åŠ›</span>
            </div>
            <div class="example-item" onclick="fillCompleteExample('', 'ä¿¡æ¯æŠ€æœ¯', 'Pythonç¼–ç¨‹åŸºç¡€ï¼šå˜é‡ä¸æ•°æ®ç±»å‹', '2è¯¾æ—¶', 'é¡¹ç›®å¼å­¦ä¹ ', 'å°ç­ (20äººä»¥ä¸‹)')">
                <strong>ç¼–ç¨‹æ•™å­¦æ•™æ¡ˆ</strong>
                <span>PythonåŸºç¡€ - é¡¹ç›®å¼å­¦ä¹ ï¼Œé€‚åˆå°ç­ç²¾ç»†åŒ–æ•™å­¦</span>
            </div>
        </div>

        <div class="footer">
            Powered by æ™ºè°±AI GLM-4 | Â© 2025
        </div>
    </div>

    <script>
        function updateSliderValue(value) {
            document.getElementById('slideValue').textContent = value;
        }

        function fillExample(grade, subject, topic) {
            document.getElementById('grade').value = grade;
            document.getElementById('subject').value = subject;
            document.getElementById('topic').value = topic;
            document.getElementById('topic').focus();
        }

        function fillCompleteExample(grade, subject, topic, duration, teaching_method, class_size) {
            document.getElementById('grade').value = grade;
            document.getElementById('subject').value = subject;
            document.getElementById('topic').value = topic;
            document.getElementById('duration').value = duration;
            document.getElementById('teaching_method').value = teaching_method;
            document.getElementById('class_size').value = class_size;
            document.getElementById('topic').focus();
        }

        function showAlert(message, type) {
            const alert = document.getElementById('alert');
            alert.className = `alert ${type} show`;
            alert.innerHTML = message;
            
            if (type === 'success') {
                setTimeout(() => {
                    alert.classList.remove('show');
                }, 10000);
            }
        }

        document.getElementById('pptForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const submitBtn = document.getElementById('submitBtn');
            const formData = {
                grade: document.getElementById('grade').value,
                subject: document.getElementById('subject').value,
                topic: document.getElementById('topic').value,
                duration: document.getElementById('duration').value,
                teaching_method: document.getElementById('teaching_method').value,
                class_size: document.getElementById('class_size').value,
                num_slides: document.getElementById('num_slides').value
            };

            // éªŒè¯
            if (!formData.topic.trim()) {
                showAlert('è¯·è¾“å…¥æ•™æ¡ˆä¸»é¢˜', 'error');
                return;
            }

            // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
            submitBtn.classList.add('loading');
            submitBtn.disabled = true;

            try {
                const response = await fetch('/generate', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(formData)
                });

                const result = await response.json();

                if (result.success) {
                    showAlert(
                        `âœ… ${result.message}<br>` +
                        `<a href="${result.download_url}" class="download-link" download>ğŸ“¥ ç‚¹å‡»ä¸‹è½½PPT</a>`,
                        'success'
                    );
                } else {
                    showAlert(`âŒ ${result.error}`, 'error');
                }
            } catch (error) {
                showAlert(`âŒ ç”Ÿæˆå¤±è´¥: ${error.message}`, 'error');
            } finally {
                submitBtn.classList.remove('loading');
                submitBtn.disabled = false;
            }
        });
    </script>
</body>
</html>
